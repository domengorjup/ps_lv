
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Procesiranje slik za meritve v eksperimentalni modalni analizi &#8212; Procesiranje signalov - Laboratorijske vaje</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/lv_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Procesiranje signalov - Laboratorijske vaje</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Uvod
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01%20-%20Uvod%20v%20LabView.html">
   1. Uvod v LabView
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02%20-%20LabView%20in%20Arduino%2C%20Python.html">
   2. LabView in Arduino, Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03%20-%20Fourierova%20integralska%20transformacija.html">
   3. Fourierova integralska transformacija
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04%20-%20Lastnosti%20Fourierove%20transformacije.html">
   4. Lastnosti Fourierove transformacije
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05%20-%20LTI%20sistemi%2C%20zajem%20signalov.html">
   5. Linearni, časovno invariatni (LTI) sistemi - zajem signalov
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06%20-%20LTI%20sistemi%202%2C%20prenosne%20funkcije.html">
   6. Linearni, časovno invariatni (LTI) sistemi 2 - prenosne funkcije
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07%20-%20Enakomerno%20%C4%8Dasovno%20vzor%C4%8Denje%20in%20frekven%C4%8Dno%20prekrivanje.html">
   7. Enakomerno časovno vzorčenje in frekvenčno prekrivanje
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08%20-%20DFT%20in%20osnove%20naklju%C4%8Dnih%20procesov.html">
   8. DFT in osnove naključnih procesov
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09%20-%20Naklju%C4%8Dno%20vzbujanje%2C%20zajem%20signalov.html">
   9. Naključno vzbujanje - zajem signalov
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v eksperimentalni modalni analizi.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/domengorjup/ps_lv"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/domengorjup/ps_lv/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v eksperimentalni modalni analizi.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/domengorjup/ps_lv/main?urlpath=tree/lv_book/notebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v eksperimentalni modalni analizi.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slikovne-meritve">
   Slikovne meritve
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametri-zajema">
     Parametri zajema
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#osvetlitev">
     Osvetlitev
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#priprava-povrsine-merjenca">
     Priprava površine merjenca
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pogoste-tezave-pri-slikovnih-meritvah">
     Pogoste težave pri slikovnih meritvah
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#neustrezno-izostrena-slika">
       Neustrezno izostrena slika
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#neustrezna-osvetlitev">
       Neustrezna osvetlitev
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">
   Določitev pomikov na slikah z metodo optičnega toka
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metoda-lucas-kanade">
   Metoda Lucas-Kanade:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#izracun-frf">
   Izračun FRF
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev">
   Eskperimentalna modalna analiza (samo slikovna meritev):
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-hibridna-metoda">
   Eskperimentalna modalna analiza - hibridna metoda
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Procesiranje slik za meritve v eksperimentalni modalni analizi</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#slikovne-meritve">
   Slikovne meritve
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametri-zajema">
     Parametri zajema
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#osvetlitev">
     Osvetlitev
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#priprava-povrsine-merjenca">
     Priprava površine merjenca
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pogoste-tezave-pri-slikovnih-meritvah">
     Pogoste težave pri slikovnih meritvah
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#neustrezno-izostrena-slika">
       Neustrezno izostrena slika
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#neustrezna-osvetlitev">
       Neustrezna osvetlitev
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">
   Določitev pomikov na slikah z metodo optičnega toka
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metoda-lucas-kanade">
   Metoda Lucas-Kanade:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#izracun-frf">
   Izračun FRF
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev">
   Eskperimentalna modalna analiza (samo slikovna meritev):
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-hibridna-metoda">
   Eskperimentalna modalna analiza - hibridna metoda
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="procesiranje-slik-za-meritve-v-eksperimentalni-modalni-analizi">
<h1>Procesiranje slik za meritve v eksperimentalni modalni analizi<a class="headerlink" href="#procesiranje-slik-za-meritve-v-eksperimentalni-modalni-analizi" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Slikovne-meritve" data-toc-modified-id="Slikovne-meritve-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Slikovne meritve</a></span><ul class="toc-item"><li><span><a href="#Parametri-zajema" data-toc-modified-id="Parametri-zajema-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Parametri zajema</a></span></li><li><span><a href="#Osvetlitev" data-toc-modified-id="Osvetlitev-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Osvetlitev</a></span></li><li><span><a href="#Priprava-površine-merjenca" data-toc-modified-id="Priprava-površine-merjenca-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Priprava površine merjenca</a></span></li><li><span><a href="#Pogoste-težave-pri-slikovnih-meritvah" data-toc-modified-id="Pogoste-težave-pri-slikovnih-meritvah-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Pogoste težave pri slikovnih meritvah</a></span><ul class="toc-item"><li><span><a href="#Neustrezno-izostrena-slika" data-toc-modified-id="Neustrezno-izostrena-slika-1.4.1"><span class="toc-item-num">1.4.1&nbsp;&nbsp;</span>Neustrezno izostrena slika</a></span></li><li><span><a href="#Neustrezna-osvetlitev" data-toc-modified-id="Neustrezna-osvetlitev-1.4.2"><span class="toc-item-num">1.4.2&nbsp;&nbsp;</span>Neustrezna osvetlitev</a></span></li></ul></li></ul></li><li><span><a href="#Določitev-pomikov-na-slikah-z-metodo-optičnega-toka-(Simplified-Optical-Flow)" data-toc-modified-id="Določitev-pomikov-na-slikah-z-metodo-optičnega-toka-(Simplified-Optical-Flow)-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Določitev pomikov na slikah z metodo optičnega toka (<em>Simplified Optical Flow</em>)</a></span></li><li><span><a href="#Metoda-Lucas-Kanade:" data-toc-modified-id="Metoda-Lucas-Kanade:-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Metoda Lucas-Kanade:</a></span></li><li><span><a href="#Izračun-FRF" data-toc-modified-id="Izračun-FRF-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Izračun FRF</a></span></li><li><span><a href="#Eskperimentalna-modalna-analiza-(samo-slikovn-meritev):" data-toc-modified-id="Eskperimentalna-modalna-analiza-(samo-slikovn-meritev):-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Eskperimentalna modalna analiza (samo slikovn meritev):</a></span></li><li><span><a href="#Eskperimentalna-modalna-analiza---hibridna-metoda" data-toc-modified-id="Eskperimentalna-modalna-analiza---hibridna-metoda-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Eskperimentalna modalna analiza - hibridna metoda</a></span></li></ul></div><p>V tej predstavitvi so uporabljeni naslednji paketi:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">lvm_read</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyFRF</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyidi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pyEMA</span></code></p></li>
</ul>
<p>Priprava paketov in nekaterih funkcij:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">from</span> <span class="nn">matplotlib.animation</span> <span class="kn">import</span> <span class="n">FuncAnimation</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">zoomed_inset_axes</span><span class="p">,</span> <span class="n">mark_inset</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">lvm_read</span>
<span class="kn">import</span> <span class="nn">pyFRF</span>
<span class="kn">import</span> <span class="nn">pyidi</span>
<span class="kn">import</span> <span class="nn">pyEMA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\numpy\distutils\ccompiler.py:17: DeprecationWarning: The distutils.sysconfig module is deprecated, use sysconfig instead
  from distutils.sysconfig import customize_compiler
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyEMA\__init__.py:12: UserWarning: This is the last version of pyEMA and will not longer be maintained since it is moving to the SDyPy package. To use the latest code from SDyPy: `pip install sdypy` and `from sdypy import EMA`.
  warnings.warn(&#39;This is the last version of pyEMA and will not longer be maintained since it is moving to the SDyPy package. To use the latest code from SDyPy: `pip install sdypy` and `from sdypy import EMA`.&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">font_size</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">fig_size</span> <span class="o">=</span> <span class="p">(</span><span class="mf">16.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fig_size</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font_size</span>


<span class="k">def</span> <span class="nf">show_modal_data</span><span class="p">(</span><span class="n">nat_freq</span><span class="p">,</span> <span class="n">damping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show modal data in a table-like structure.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;   Nat. f.      Damping&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">23</span><span class="o">*</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nat_freq</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">) </span><span class="si">{</span><span class="n">f</span><span class="si">:</span><span class="s1">6.1f</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">damping</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">5.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        

<span class="k">def</span> <span class="nf">plot_mode_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a mode shape in a consistent fashion.&quot;&quot;&quot;</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">shape</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">shape</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                     <span class="n">style</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frequency</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mode shape - </span><span class="si">{</span><span class="n">frequency</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>
    <span class="n">axis</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="slikovne-meritve">
<h2>Slikovne meritve<a class="headerlink" href="#slikovne-meritve" title="Permalink to this headline">¶</a></h2>
<p><strong>Postavitev eksperimenta:</strong></p>
<img src="figures/experiment_setup.jpg" width="80%"><p><strong>Vzbujanje z modalnim kladivom:</strong></p>
<video controls loop src="figures/experiment.mp4" width="100%" rotate="270deg"/><p>Datoteke s slikami:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam_fname</span> <span class="o">=</span> <span class="s1">&#39;data/camera.cih&#39;</span>
<span class="n">lvm_fname</span> <span class="o">=</span> <span class="s1">&#39;data/acceleration.lvm&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Odpiranje posnetka s paketom <a class="reference external" href="https://github.com/ladisk/pyidi">pyidi</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">cam_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyMRAW.py:91: UserWarning: Not 12bit (8 bits)! clipped values?
  warnings.warn(&#39;Not 12bit ({:g} bits)! clipped values?&#39;.format(bits))
C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyMRAW.py:103: UserWarning: Clipped footage! (Total frame: 3750, Original total frame: 7500)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequential_image_nr</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">sequential_image_nr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_15_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_15_0.png" />
</div>
</div>
<p><em>Posnetek je prilagojen prikazu in je zato slabše kavlaitete. Za natančne meritve običajno zajamemo zel oveliko količino podatkov.</em></p>
<video controls loop src="figures/video.MOV" width="950" rotate="270deg"/><div class="section" id="parametri-zajema">
<h3>Parametri zajema<a class="headerlink" href="#parametri-zajema" title="Permalink to this headline">¶</a></h3>
<p>Parametri nastavitve kamere so zapisani v atributu <code class="docutils literal notranslate"><span class="pre">info</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Date&#39;: &#39;2018/12/17&#39;,
 &#39;Time&#39;: &#39;12:48&#39;,
 &#39;Camera Type&#39;: &#39;FASTCAM SA-Z type 2100K-M-64GB&#39;,
 &#39;Head Type&#39;: &#39;Unknown Child Device&#39;,
 &#39;Camera ID&#39;: 11,
 &#39;Camera Number&#39;: 0,
 &#39;Head Number&#39;: 1,
 &#39;Max Head Number&#39;: 1,
 &#39;Scene Name&#39;: &#39;&#39;,
 &#39;User Defined Camera Name&#39;: &#39;&#39;,
 &#39;Session Number&#39;: &#39;&#39;,
 &#39;Date Record&#39;: &#39;Unknown&#39;,
 &#39;Time Record&#39;: &#39;Unknown&#39;,
 &#39;Trigger Time&#39;: 0,
 &#39;Record Rate(fps)&#39;: 15000,
 &#39;Shutter Speed(s)&#39;: &#39;1/15371&#39;,
 &#39;Trigger Mode&#39;: &#39;Start&#39;,
 &#39;Original Total Frame&#39;: 7500,
 &#39;Total Frame&#39;: 3750,
 &#39;Start Frame&#39;: 0,
 &#39;Correct Trigger Frame&#39;: 0,
 &#39;Save Step&#39;: 1,
 &#39;Image Width&#39;: 640,
 &#39;Image Height&#39;: 40,
 &#39;Color Type&#39;: &#39;Mono&#39;,
 &#39;Color Bit&#39;: 8,
 &#39;File Format&#39;: &#39;MRaw&#39;,
 &#39;EffectiveBit Depth&#39;: 12,
 &#39;EffectiveBit Side&#39;: &#39;Higher&#39;,
 &#39;Digits Of File Number&#39;: 6,
 &#39;Device Last Error&#39;: &#39;-1:0xffffffff&#39;,
 &#39;Comment Text&#39;: &#39;&#39;,
 &#39;AnalogBoard Channel Num&#39;: 0,
 &#39;Zero Frame&#39;: &#39;Exist&#39;,
 &#39;Shutter Type2(nsec)&#39;: 65060,
 &#39;Edge Enhance&#39;: 0,
 &#39;Pre LUT Mode&#39;: &#39;DEF1&#39;,
 &#39;Pre LUT Brightness&#39;: 0,
 &#39;Pre LUT Contrast&#39;: 0,
 &#39;Pre LUT Gain&#39;: 1.0,
 &#39;Pre LUT Gamma&#39;: 1.0,
 &#39;Pre LUT PosiNega&#39;: &#39;Posi&#39;,
 &#39;DS Shutter&#39;: &#39;Value 0&#39;,
 &#39;Scale Method&#39;: 1,
 &#39;Scale Grid Space&#39;: 1,
 &#39;Scale Pixel Size&#39;: 47.193,
 &#39;Scale Unit&#39;: 1,
 &#39;Scale Magnification&#39;: 1.0,
 &#39;Scale Ruler&#39;: 1,
 &#39;Scale Distance&#39;: 1000.0,
 &#39;Scale 2Points Distance&#39;: 21.1896,
 &#39;Polarization&#39;: 0,
 &#39;Pola Config&#39;: 0,
 &#39;Pola Save Kind&#39;: 0,
 &#39;Pola Save Comment&#39;: &#39;&#39;,
 &#39;Time Code Type&#39;: 0,
 &#39;Time Code Display Unit&#39;: &#39;&#39;,
 &#39;Time Code Per Frames&#39;: 0.0,
 &#39;Time Code Start Value&#39;: 0.0,
 &#39;Time Code Unit Reset&#39;: 0.0,
 &#39;Time Code Reset&#39;: 0,
 &#39;Current Time Decimal Place&#39;: 0,
 &#39;Current Time Max Display Unit&#39;: 0,
 &#39;Current Time Decimal Divide&#39;: 0,
 &#39;Not Use&#39;: &#39;&#39;,
 &#39;Auto Exposure&#39;: &#39;Off&#39;,
 &#39;Shading&#39;: &#39;On&#39;,
 &#39;Pixel Gain&#39;: &#39;Default&#39;,
 &#39;Sync In&#39;: &#39;OFF&#39;,
 &#39;General In&#39;: &#39;EVENT POS&#39;,
 &#39;Trig TTL In&#39;: &#39;TRIG POS&#39;,
 &#39;General Out1&#39;: &#39;SYNC POS&#39;,
 &#39;General Out2&#39;: &#39;SYNC POS&#39;,
 &#39;General Out3&#39;: &#39;SYNC POS&#39;,
 &#39;Trig TTL Out&#39;: &#39;TRIG POS&#39;,
 &#39;SYNC OUT Times(times)&#39;: 1,
 &#39;IRIG&#39;: &#39;Off&#39;,
 &#39;IRIG Phase Lock&#39;: &#39;Off&#39;,
 &#39;Video Out&#39;: &#39;PAL&#39;,
 &#39;Video Out during Memory&#39;: &#39;Off&#39;,
 &#39;Total Partition&#39;: 1,
 &#39;Current Partition&#39;: 1,
 &#39;Partition 1&#39;: &#39;1789403(frame)&#39;,
 &#39;Hardware Partition Increment Mode&#39;: &#39;Off&#39;,
 &#39;Signal Delay Trigger In(nsec)&#39;: 0,
 &#39;Signal Delay Sync In(nsec)&#39;: 0,
 &#39;Signal Delay General In(nsec)&#39;: 0,
 &#39;Signal Delay VSync Out(nsec)&#39;: 0,
 &#39;Signal Delay Exposure Out(nsec)&#39;: 0,
 &#39;Signal Delay Trigger Out Width(nsec)&#39;: 10000,
 &#39;Signal Delay VSync Out Width(nsec)&#39;: 4600,
 &#39;Locked Shutter Speed&#39;: &#39;Off&#39;,
 &#39;Hardware Recording Type&#39;: &#39;READY AND TRIG&#39;,
 &#39;Locked Resolution&#39;: &#39;Off&#39;}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="osvetlitev">
<h3>Osvetlitev<a class="headerlink" href="#osvetlitev" title="Permalink to this headline">¶</a></h3>
<p>Ustrezna osvetlitev je eden najpomembnejših parametrov pri zajemu slik s hitro kamero.</p>
<p>Pri oceni ustreznosti osvetlitve si lahko pomagamo s hitrogramom sivinskih vrendosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_frame</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># position of observed rectangle</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span><span class="n">y0</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x0</span><span class="o">+</span><span class="n">d</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">roi</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
<span class="c1"># Formating</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grayscale value [/]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n pixels [/]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_22_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_22_0.png" />
</div>
</div>
</div>
<div class="section" id="priprava-povrsine-merjenca">
<h3>Priprava površine merjenca<a class="headerlink" href="#priprava-povrsine-merjenca" title="Permalink to this headline">¶</a></h3>
<p>Za delovanje metod določanja pomikov s slik na osnovi gradientov sivinskih vrendosti je nujno, da je površina merjenca ustrezno pripravljena.</p>
<p>Pogosto na opazovano površino apliciramo visokokontrasntni vzorec pack (<em>speckle</em>) ali črt. Identifikacija pomikov je najzaneslivejša v smeri gradienta sivinskih vrendosti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad0</span><span class="p">,</span> <span class="n">grad1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span> <span class="c1"># gradient computation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># position of cross section</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="p">:,</span> <span class="n">x0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Grayscale value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grad0</span><span class="p">[:,</span> <span class="n">x0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gradient&#39;</span><span class="p">)</span>
<span class="c1"># Formating</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Cross section&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image height [px]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Grayscale/gradient value [/]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_25_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_25_0.png" />
</div>
</div>
</div>
<div class="section" id="pogoste-tezave-pri-slikovnih-meritvah">
<h3>Pogoste težave pri slikovnih meritvah<a class="headerlink" href="#pogoste-tezave-pri-slikovnih-meritvah" title="Permalink to this headline">¶</a></h3>
<div class="section" id="neustrezno-izostrena-slika">
<h4>Neustrezno izostrena slika<a class="headerlink" href="#neustrezno-izostrena-slika" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout_fname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data/focus.cih&#39;</span>
<span class="n">video_layout</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">layout_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyMRAW.py:91: UserWarning: Not 12bit (8 bits)! clipped values?
  warnings.warn(&#39;Not 12bit ({:g} bits)! clipped values?&#39;.format(bits))
C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyMRAW.py:103: UserWarning: Clipped footage! (Total frame: 1, Original total frame: 44)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video_layout</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># Formating</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_29_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_29_0.png" />
</div>
</div>
</div>
<div class="section" id="neustrezna-osvetlitev">
<h4>Neustrezna osvetlitev<a class="headerlink" href="#neustrezna-osvetlitev" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">light_fname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data/illumination.cih&#39;</span>
<span class="n">video_light</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">light_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyMRAW.py:103: UserWarning: Clipped footage! (Total frame: 1, Original total frame: 34)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_frame</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y0</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">20</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">video_light</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span><span class="n">y0</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x0</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video_light</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">roi</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
    <span class="c1"># Formating</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">d</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grayscale value [/]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n pixels [/]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">260</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">interact</span><span class="p">(</span><span class="n">show</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\ipykernel\pylab\backend_inline.py:11: DeprecationWarning: `ipykernel.pylab.backend_inline` is deprecated, directly use `matplotlib_inline.backend_inline`
  warnings.warn(
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "7b3269affedc4fdd9dbd5eaaabadaec2"}
</script></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">
<h2>Določitev pomikov na slikah z metodo optičnega toka<a class="headerlink" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka" title="Permalink to this headline">¶</a></h2>
<p>Svetlost na sliki se ohranja:
$<span class="math notranslate nohighlight">\(
	f(x, y, t) = f(x + \Delta x, y + \Delta y, t+ \Delta t).
\)</span>$</p>
<p>Sledi enačba poenostavljene metode optičnega toka za posamezno točko na sliki:
$<span class="math notranslate nohighlight">\(
s(x_j,y_k,t)=\frac{f_0(x_j,y_k)-f(x_j,y_k,t)}{|\nabla f_0|}
\)</span>$</p>
<p><span class="math notranslate nohighlight">\(s(x_j,y_k,t) \dots\)</span> pomik točke v smeri lokalnega gadienta sivinskih vrednosti</p>
<p>(<a class="reference external" href="https://github.com/ladisk/pyidi">Javh et al</a>)</p>
<p>Računamo pomike glede na refernčno sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reference_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Potrebujemo slike gradienta v smeri <code class="docutils literal notranslate"><span class="pre">x</span></code> (1) in <code class="docutils literal notranslate"><span class="pre">y</span></code> (0):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad0</span><span class="p">,</span> <span class="n">grad1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">reference_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">grad0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">grad1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Za obdelavo so primerne točke z visoko vrednostjo gradienta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">border</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">border_h</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="n">reference_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">border</span> <span class="o">-</span> <span class="n">reference_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">border</span><span class="p">)</span><span class="o">//</span><span class="n">N</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">grad0</span><span class="p">[</span><span class="n">border_h</span><span class="p">:</span><span class="o">-</span><span class="n">border_h</span><span class="p">,</span> <span class="n">w</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">border_h</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">h</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">w</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grad0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">inds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">inds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gradient in $y$-direction&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_43_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_43_0.png" />
</div>
</div>
<p>Enačba optičnega toka:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_of</span> <span class="o">=</span> <span class="p">((</span><span class="n">reference_image</span><span class="p">[</span><span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[:,</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span><span class="o">.</span><span class="n">T</span>
<span class="n">d_of</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, 3750)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d_of</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1663b6481f0&gt;
</pre></div>
</div>
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_46_1.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_46_1.png" />
</div>
</div>
<p>Izračun pomikov s <code class="docutils literal notranslate"><span class="pre">pyidi</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_points</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">inds</span><span class="p">)</span> <span class="c1"># izbira točk za analizo</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sof&#39;</span><span class="p">,</span>
                <span class="n">mean_n_neighbours</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračun pomikov z <code class="docutils literal notranslate"><span class="pre">get_displacements()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get_displacements</span><span class="p">()</span> <span class="o">*</span> <span class="mf">8e-5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                      | 0/3750 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  3%|█▌                                                          | 95/3750 [00:00&lt;00:03, 947.28it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|███                                                        | 196/3750 [00:00&lt;00:03, 980.28it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|████▋                                                      | 295/3750 [00:00&lt;00:04, 839.89it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|██████                                                     | 384/3750 [00:00&lt;00:03, 857.07it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|███████▌                                                   | 480/3750 [00:00&lt;00:03, 889.59it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 15%|█████████                                                  | 576/3750 [00:00&lt;00:03, 911.77it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|██████████▌                                                | 669/3750 [00:00&lt;00:03, 885.58it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|███████████▉                                               | 760/3750 [00:00&lt;00:03, 890.79it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|█████████████▌                                             | 863/3750 [00:00&lt;00:03, 930.58it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|███████████████                                            | 958/3750 [00:01&lt;00:02, 936.16it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 28%|████████████████▎                                         | 1058/3750 [00:01&lt;00:02, 953.68it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 31%|█████████████████▉                                        | 1162/3750 [00:01&lt;00:02, 978.55it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 34%|███████████████████▌                                      | 1262/3750 [00:01&lt;00:02, 982.26it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|█████████████████████                                     | 1361/3750 [00:01&lt;00:02, 963.70it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 39%|██████████████████████▌                                   | 1458/3750 [00:01&lt;00:02, 953.03it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 41%|████████████████████████                                  | 1554/3750 [00:01&lt;00:02, 950.31it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|█████████████████████████▊                                | 1665/3750 [00:01&lt;00:02, 995.80it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|███████████████████████████                              | 1783/3750 [00:01&lt;00:01, 1049.85it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|████████████████████████████▋                            | 1889/3750 [00:01&lt;00:01, 1020.36it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|██████████████████████████████▎                          | 1992/3750 [00:02&lt;00:01, 1013.69it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 56%|███████████████████████████████▊                         | 2094/3750 [00:02&lt;00:01, 1010.77it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 59%|█████████████████████████████████▉                        | 2196/3750 [00:02&lt;00:01, 977.46it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 61%|███████████████████████████████████▍                      | 2295/3750 [00:02&lt;00:01, 957.91it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|█████████████████████████████████████▏                    | 2403/3750 [00:02&lt;00:01, 991.43it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|██████████████████████████████████████                   | 2507/3750 [00:02&lt;00:01, 1003.05it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|████████████████████████████████████████▎                 | 2608/3750 [00:02&lt;00:01, 720.49it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 72%|█████████████████████████████████████████▋                | 2692/3750 [00:03&lt;00:01, 645.94it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 74%|██████████████████████████████████████████▊               | 2766/3750 [00:03&lt;00:01, 657.10it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|████████████████████████████████████████████▏             | 2853/3750 [00:03&lt;00:01, 706.26it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|█████████████████████████████████████████████▍            | 2936/3750 [00:03&lt;00:01, 736.09it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 80%|██████████████████████████████████████████████▋           | 3015/3750 [00:03&lt;00:01, 713.64it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|███████████████████████████████████████████████▊          | 3090/3750 [00:03&lt;00:00, 699.90it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|████████████████████████████████████████████████▉         | 3163/3750 [00:03&lt;00:00, 658.01it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 86%|█████████████████████████████████████████████████▉        | 3231/3750 [00:03&lt;00:00, 591.68it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|██████████████████████████████████████████████████▉       | 3297/3750 [00:03&lt;00:00, 608.61it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|████████████████████████████████████████████████████▏     | 3373/3750 [00:04&lt;00:00, 647.82it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|█████████████████████████████████████████████████████▎    | 3444/3750 [00:04&lt;00:00, 663.66it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|██████████████████████████████████████████████████████▌   | 3527/3750 [00:04&lt;00:00, 708.45it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 96%|███████████████████████████████████████████████████████▊  | 3609/3750 [00:04&lt;00:00, 738.62it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|████████████████████████████████████████████████████████▉ | 3685/3750 [00:04&lt;00:00, 742.29it/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████| 3750/3750 [00:04&lt;00:00, 826.70it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Averaging...
Finished!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\methods\_simplified_optical_flow.py:138: UserWarning: Displacement larger than 0.5 pixel
  warnings.warn(&#39;Displacement larger than 0.5 pixel&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">location</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements</span><span class="p">[</span><span class="n">location</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x16635999c60&gt;
</pre></div>
</div>
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_53_1.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_53_1.png" />
</div>
</div>
</div>
<div class="section" id="metoda-lucas-kanade">
<h2>Metoda Lucas-Kanade:<a class="headerlink" href="#metoda-lucas-kanade" title="Permalink to this headline">¶</a></h2>
<p>Če enačbe optičnega toka zapišemo za podobmočje več točk na sliki, dobimo predoločen sistem enačb.</p>
<p>Rešitev predoločenega sistema v smislu najmanjše kvadratične napake nam da pomik podobmočja:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	\begin{bmatrix}
		\Delta x \\
		\Delta y
	\end{bmatrix} =
	\begin{bmatrix}
		\sum g_x^2 &amp;\sum  g_x \, g_y \\
		\sum  g_x \, g_y &amp;\sum g_y^2
	\end{bmatrix}^{-1}
	\begin{bmatrix}
		\sum g_x \, (f-g) \\
		\sum g_y \, (f-g)
	\end{bmatrix}
\end{equation}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(f(\mathbf{x}) \dots\)</span> trenutna (premaknjena) slika</p>
<p><span class="math notranslate nohighlight">\(g(\mathbf{x}) \dots\)</span> referenčna slika</p>
<p>Do enake rešitve pridemo, če rešim opzimizacijski problem, v katerem iščemo parametre <span class="math notranslate nohighlight">\(\Delta \mathbf{x}\)</span>, ki premaknjeno trenutno sliko <span class="math notranslate nohighlight">\(f(\mathbf{x} + \Delta \mathbf{x})\)</span> poravnajo z referenčno <span class="math notranslate nohighlight">\(g(\mathbf{x})\)</span>:</p>
<div class="math notranslate nohighlight">
\[
SSD(\Delta \mathbf{x}) = \sum\limits_{x, y} \big[f(\mathbf{x} + \Delta \mathbf{x}) - g(\mathbf{x})\big]^2.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_lk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Image Height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_points</span><span class="p">(</span><span class="n">points_lk</span><span class="p">)</span>
<span class="n">video</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;lk&#39;</span><span class="p">,</span> <span class="n">roi_size</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="n">max_nfev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">int_order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_lk</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">show_points</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_60_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_60_0.png" />
</div>
</div>
<p>Izrčaun pomikov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements_lk</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get_displacements</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8e-5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\methods\_lucas_kanade.py:556: ResourceWarning: unclosed file &lt;_io.BufferedReader name=&#39;data\\temp_file\\settings.pkl&#39;&gt;
  settings_old = pickle.load(open(self.settings_filename, &#39;rb&#39;))
ResourceWarning: Enable tracemalloc to get the object allocation traceback
C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\methods\_lucas_kanade.py:568: ResourceWarning: unclosed file &lt;_io.BufferedReader name=&#39;data\\temp_file\\points.pkl&#39;&gt;
  points = pickle.load(open(os.path.join(self.temp_dir, &#39;points.pkl&#39;), &#39;rb&#39;))
ResourceWarning: Enable tracemalloc to get the object allocation traceback
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-- Resuming last analysis ---
 
Computation start: 2023-03-22 11:36:02.648890
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d89703c52ae84dec8cf9e54fcd4fd422"}
</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\tornado\ioloop.py:263: DeprecationWarning: There is no current event loop
  loop = asyncio.get_event_loop()
sys:1: ResourceWarning: unclosed socket &lt;zmq.Socket(zmq.PUSH) at 0x1663bf900a0&gt;
ResourceWarning: Enable tracemalloc to get the object allocation traceback
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>sys:1: ResourceWarning: unclosed socket &lt;zmq.Socket(zmq.PUSH) at 0x1663bf5fa00&gt;
ResourceWarning: Enable tracemalloc to get the object allocation traceback
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_19700</span><span class="o">/</span><span class="mf">952502707.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">displacements_lk</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get_displacements</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">8e-5</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\pyidi.py</span> in <span class="ni">get_displacements</span><span class="nt">(self, autosave, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span><span class="sd">         if hasattr(self, &#39;method&#39;):</span>
<span class="ne">--&gt; </span><span class="mi">179</span><span class="sd">             self.method.calculate_displacements(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">180</span><span class="sd">             self.displacements = self.method.displacements</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span><span class="sd"> </span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\methods\_lucas_kanade.py</span> in <span class="ni">calculate_displacements</span><span class="nt">(self, video, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span><span class="sd">                 self.create_temp_files(init_multi=True)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span><span class="sd"> </span>
<span class="ne">--&gt; </span><span class="mi">188</span><span class="sd">             self.displacements = multi(video, self.processes)</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span><span class="sd">             # return?</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span><span class="sd"> </span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\pyidi\methods\_lucas_kanade.py</span> in <span class="ni">multi</span><span class="nt">(video, processes)</span>
<span class="g g-Whitespace">    </span><span class="mi">696</span><span class="sd">             for i, p in enumerate(points_split):</span>
<span class="g g-Whitespace">    </span><span class="mi">697</span><span class="sd">                 mcore.run(worker, p, idi_kwargs, method_kwargs, i)</span>
<span class="ne">--&gt; </span><span class="mi">698</span><span class="sd">             returns = mcore.returns()</span>
<span class="g g-Whitespace">    </span><span class="mi">699</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">700</span><span class="sd">         out = []</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\mantichora\main.py</span> in <span class="ni">returns</span><span class="nt">(self)</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">77</span><span class="sd">         &quot;&quot;&quot;</span>
<span class="ne">---&gt; </span><span class="mi">78</span>         <span class="n">pairs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">receive_all</span><span class="p">()</span> <span class="c1"># list of pairs (runid, result)</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span>         <span class="k">return</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> 

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\mantichora\main.py</span> in <span class="ni">receive_all</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> 
<span class="g g-Whitespace">    </span><span class="mi">109</span>     <span class="k">def</span> <span class="nf">receive_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">110</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hub</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> 
<span class="g g-Whitespace">    </span><span class="mi">112</span>     <span class="k">def</span> <span class="nf">terminate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\mantichora\hubmp.py</span> in <span class="ni">receive</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span>         <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span> <span class="c1"># a list of (task_idx, result)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span>         <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_ongoing_tasks</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">164</span>             <span class="n">messages</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receive_finished</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> 
<span class="g g-Whitespace">    </span><span class="mi">166</span>         <span class="c1"># sort in the order of task_idx</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\site-packages\mantichora\hubmp.py</span> in <span class="ni">_receive_finished</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">174</span>     <span class="k">def</span> <span class="nf">_receive_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span>         <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span> <span class="c1"># a list of (task_idx, result)</span>
<span class="ne">--&gt; </span><span class="mi">176</span>         <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
<span class="g g-Whitespace">    </span><span class="mi">177</span>             <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>             <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\multiprocessing\queues.py</span> in <span class="ni">empty</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">127</span> 
<span class="g g-Whitespace">    </span><span class="mi">128</span>     <span class="k">def</span> <span class="nf">empty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">129</span>         <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poll</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span> 
<span class="g g-Whitespace">    </span><span class="mi">131</span>     <span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\multiprocessing\connection.py</span> in <span class="ni">poll</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_closed</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_readable</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">262</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poll</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> 
<span class="g g-Whitespace">    </span><span class="mi">264</span>     <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\multiprocessing\connection.py</span> in <span class="ni">_poll</span><span class="nt">(self, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">333</span>                         <span class="n">_winapi</span><span class="o">.</span><span class="n">PeekNamedPipe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">334</span>                 <span class="k">return</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">335</span>             <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">wait</span><span class="p">([</span><span class="bp">self</span><span class="p">],</span> <span class="n">timeout</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">336</span> 
<span class="g g-Whitespace">    </span><span class="mi">337</span>         <span class="k">def</span> <span class="nf">_get_more_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ov</span><span class="p">,</span> <span class="n">maxsize</span><span class="p">):</span>

<span class="nn">~\AppData\Local\Programs\Python\Python310\lib\multiprocessing\connection.py</span> in <span class="ni">wait</span><span class="nt">(object_list, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">886</span>             <span class="c1"># request that overlapped reads stop</span>
<span class="g g-Whitespace">    </span><span class="mi">887</span>             <span class="k">for</span> <span class="n">ov</span> <span class="ow">in</span> <span class="n">ov_list</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">888</span>                 <span class="n">ov</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">889</span> 
<span class="g g-Whitespace">    </span><span class="mi">890</span>             <span class="c1"># wait for all overlapped reads to stop</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#displacements_lk = np.load(&#39;data/displacements_lk.npy&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">točka</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements_lk</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y), DIC&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements</span><span class="p">[</span><span class="n">location</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y), optični tok&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1ec65dca320&gt;
</pre></div>
</div>
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_65_1.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_65_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">displacements_lk</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="izracun-frf">
<h2>Izračun FRF<a class="headerlink" href="#izracun-frf" title="Permalink to this headline">¶</a></h2>
<p>Izračun amplitudnih spektrov pomikov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Total Frame&#39;</span><span class="p">])</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nb">int</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Record Rate(fps)&#39;</span><span class="p">])</span>
<span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">N</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">upper_f_limit</span> <span class="o">=</span> <span class="mi">4000</span> <span class="c1"># zgornja frekvenčna meja, ki nas zanima</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">fft_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">displacements</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span> 
</pre></div>
</div>
</div>
</div>
<p>Opazujemo le frekvence pod mejo <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code> Hz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fft_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fft_cam</span><span class="p">[:,</span> <span class="n">freq_cam</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
<span class="n">freq_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">[</span><span class="n">freq_cam</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Silo vzbujanja smo merili s silomerom.</p>
<p>Da lahko meritiv kombiniaramo, je pomembna <strong>ujemajoča frekvenčna ločljivost</strong>! Tudi tukaj se omejimo do <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvm</span> <span class="o">=</span> <span class="n">lvm_read</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lvm_fname</span><span class="p">)</span>
<span class="n">force</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># 30 predvzorcev</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">force</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span> <span class="c1"># dolžina shranjenega videa je 0.25 s</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Delta_X&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fft_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">N</span>
<span class="n">freq_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">fft_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fft_force</span><span class="p">[</span><span class="n">freq_force</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
<span class="n">freq_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">freq_force</span><span class="p">[</span><span class="n">freq_force</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Ker smo zajeli le en segment ne moremo uporabiti natančnejše cneilke FRF:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_cam</span> <span class="o">=</span> <span class="n">fft_cam</span><span class="o">/</span><span class="n">fft_force</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_79_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_79_0.png" />
</div>
</div>
</div>
<div class="section" id="eskperimentalna-modalna-analiza-samo-slikovna-meritev">
<h2>Eskperimentalna modalna analiza (samo slikovna meritev):<a class="headerlink" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev" title="Permalink to this headline">¶</a></h2>
<p>Za eksperimentalno modalnoa analizo uporabimo paket <a class="reference external" href="https://github.com/ladisk/pyidi"><code class="docutils literal notranslate"><span class="pre">pyEMA</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span> <span class="o">=</span> <span class="n">pyEMA</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">,</span> <span class="n">freq_cam</span><span class="p">,</span> <span class="n">pol_order_high</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper_f_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračun polov modela frekvenčne prenosne funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">get_poles</span><span class="p">(</span><span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████████████████████| 50/50 [00:01&lt;00:00, 35.75it/s]
</pre></div>
</div>
</div>
</div>
<p>Izbrati moramo pole, ki se zdijo fizikalno smiselni (stabilni).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">stab_chart</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">all_poles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyEMA\pyEMA.py:311: UserWarning: `stab_chart()` method is deprecated. Please use the `select_poles()` method.
  warnings.warn(&#39;`stab_chart()` method is deprecated. Please use the `select_poles()` method.&#39;)
100%|██████████████████████████████████████████████████████████████| 50/50 [00:00&lt;00:00, 150.28it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SHIFT + LEFT mouse button to pick a pole.
SHIFT + RIGHT mouse button to erase the last pick.
1. Frequency: ~691 --&gt;	695.0653446992449 Hz	(xi = -0.0023)
2. Frequency: ~1887 --&gt;	1897.4506429927983 Hz	(xi = -0.0016)
3. Frequency: ~2464 --&gt;	2467.906640957225 Hz	(xi = -0.0093)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1152x576 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">print_modal_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Nat. f.      Damping
-----------------------
1)  695.1	-0.0023
2) 1897.5	-0.0016
3) 2467.9	-0.0093
</pre></div>
</div>
</div>
</div>
<p>Za rekonstrukcijo modela FRF uporabimo metodo LSFD:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_rec</span><span class="p">,</span> <span class="n">shapes_cam</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_constants</span><span class="p">(</span><span class="n">FRF_ind</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera FRF&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_rec</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed FRF&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Receptance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_90_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_90_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">shapes_cam</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">plot_mode_shape</span><span class="p">(</span><span class="n">shapes_cam</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="n">cam</span><span class="o">.</span><span class="n">nat_freq</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_91_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_91_0.png" />
</div>
</div>
</div>
<div class="section" id="eskperimentalna-modalna-analiza-hibridna-metoda">
<h2>Eskperimentalna modalna analiza - hibridna metoda<a class="headerlink" href="#eskperimentalna-modalna-analiza-hibridna-metoda" title="Permalink to this headline">¶</a></h2>
<p>Pri hibridni metodi kombiniramo pomike s slik z visoko prostorsko ločljivostjo in meritve pospeška z visoko natančnostjo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyb_acc</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">9.81</span> <span class="c1"># pospeškomer</span>
</pre></div>
</div>
</div>
</div>
<p>Za oceno FRF lahk uporabimo paket <a class="reference external" href="https://github.com/ladisk/pyidi"><code class="docutils literal notranslate"><span class="pre">pyFRF</span></code></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyFRF</span>

<span class="n">frf_</span> <span class="o">=</span> <span class="n">pyFRF</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span>
    <span class="n">sampling_freq</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">,</span>
    <span class="n">exc</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
    <span class="n">resp</span><span class="o">=</span><span class="n">hyb_acc</span><span class="p">,</span>
    <span class="n">exc_window</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span>
    <span class="n">resp_type</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span>
    <span class="n">resp_window</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyFRF.py:173: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  self.curr_meas = np.int(0)
</pre></div>
</div>
</div>
</div>
<p>Opazujemo le frekvenčno območj do <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code> Hz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_acc</span> <span class="o">=</span> <span class="n">frf_</span><span class="o">.</span><span class="n">get_f_axis</span><span class="p">()</span>
<span class="n">frf_acc</span> <span class="o">=</span> <span class="n">frf_</span><span class="o">.</span><span class="n">get_FRF</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;receptance&#39;</span><span class="p">)</span>

<span class="n">frf_acc</span> <span class="o">=</span> <span class="n">frf_acc</span><span class="p">[</span><span class="n">freq_acc</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">]</span>
<span class="n">freq_acc</span> <span class="o">=</span> <span class="n">freq_acc</span><span class="p">[</span><span class="n">freq_acc</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Pospeškomer je bil nameščen v točki z indeksom 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera FRF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_acc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_acc</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accelerometer FRF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Camera-based response at accelerometer location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_100_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_100_0.png" />
</div>
</div>
<p>Poli modela FRF so izrčaunani s hibridno metodo na podlagi meritev pospeška:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="n">pyEMA</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">frf_acc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">freq_acc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">pol_order_high</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper_f_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span><span class="o">.</span><span class="n">get_poles</span><span class="p">(</span><span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████████████████████| 50/50 [00:01&lt;00:00, 35.33it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span><span class="o">.</span><span class="n">stab_chart</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">all_poles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python310\lib\site-packages\pyEMA\pyEMA.py:311: UserWarning: `stab_chart()` method is deprecated. Please use the `select_poles()` method.
  warnings.warn(&#39;`stab_chart()` method is deprecated. Please use the `select_poles()` method.&#39;)
100%|██████████████████████████████████████████████████████████████| 50/50 [00:00&lt;00:00, 103.18it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SHIFT + LEFT mouse button to pick a pole.
SHIFT + RIGHT mouse button to erase the last pick.
1. Frequency: ~719 --&gt;	694.9558637688194 Hz	(xi = 0.0047)
2. Frequency: ~1891 --&gt;	1897.5325587429413 Hz	(xi = 0.0031)
3. Frequency: ~2772 --&gt;	2777.3298298887007 Hz	(xi = 0.0024)
4. Frequency: ~3681 --&gt;	3671.181158516763 Hz	(xi = 0.0020)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1152x576 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span><span class="o">.</span><span class="n">print_modal_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Nat. f.      Damping
-----------------------
1)  695.0	0.0047
2) 1897.5	0.0031
3) 2777.3	0.0024
4) 3671.2	0.0020
</pre></div>
</div>
</div>
</div>
<p>Poli, izračunani na podlagi pospeškov, so zanesljivejši. TUporabimo jih pri rekonstrukciji FRF s pomiki, pomerjen s kamero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam_hyb</span> <span class="o">=</span> <span class="n">pyEMA</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">,</span> <span class="n">freq_cam</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Rekonstrukcijo naredimo z uporabo polov iz pospeškomera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_hyb</span><span class="p">,</span> <span class="n">shapes_hybrid</span> <span class="o">=</span> <span class="n">cam_hyb</span><span class="o">.</span><span class="n">get_constants</span><span class="p">(</span><span class="n">whose_poles</span><span class="o">=</span><span class="n">acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera FRF&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_acc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_acc</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accelerometer FRF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_hyb</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed FRF&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_110_0.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_110_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">shapes_cam</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">cam_freq</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">nat_freq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">hybrid_f_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">acc</span><span class="o">.</span><span class="n">nat_freq</span> <span class="o">-</span> <span class="n">cam_freq</span><span class="p">))</span>
    <span class="n">plot_mode_shape</span><span class="p">(</span><span class="n">shapes_hybrid</span><span class="p">[:,</span> <span class="n">hybrid_f_index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> 
                    <span class="n">frequency</span><span class="o">=</span><span class="n">acc</span><span class="o">.</span><span class="n">nat_freq</span><span class="p">[</span><span class="n">hybrid_f_index</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hybrid&#39;</span><span class="p">)</span>
    <span class="n">plot_mode_shape</span><span class="p">(</span><span class="n">shapes_cam</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">a</span> <span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1ec65bba2c0&gt;
</pre></div>
</div>
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_111_1.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_111_1.png" />
</div>
</div>
<p>Na ta način smo pri stabilizaciji zaznali dodatno lasnto obliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">fig_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fig_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plot_mode_shape</span><span class="p">(</span><span class="n">shapes_hybrid</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> 
                <span class="n">frequency</span><span class="o">=</span><span class="n">acc</span><span class="o">.</span><span class="n">nat_freq</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Hybrid&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1ec6937b280&gt;
</pre></div>
</div>
<img alt="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_113_1.png" src="../../_images/Procesiranje slik za meritve v eksperimentalni modalni analizi_113_1.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks\Predavanje 12 - Procesiranje slik"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Domen Gorjup<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>