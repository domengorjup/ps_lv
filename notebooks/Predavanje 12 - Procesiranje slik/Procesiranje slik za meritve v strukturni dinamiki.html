
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Procesiranje slik za meritve v strukturni dinamiki &#8212; Procesiranje signalov - Laboratorijske vaje</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v strukturni dinamiki';</script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/lv_logo.png" class="logo__image only-light" alt="Procesiranje signalov - Laboratorijske vaje - Home"/>
    <script>document.write(`<img src="../../_static/lv_logo.png" class="logo__image only-dark" alt="Procesiranje signalov - Laboratorijske vaje - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Procesiranje signalov
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01%20-%20Uvod%20v%20LabView.html">Uvod v LabView</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02%20-%20LabView%20in%20Arduino%2C%20Python.html">LabView in Arduino, Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03%20-%20Fourierova%20integralska%20transformacija.html">Fourierova integralska transformacija</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04%20-%20Lastnosti%20Fourierove%20transformacije.html">Lastnosti Fourierove transformacije</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05%20-%20LTI%20sistemi%2C%20zajem%20signalov.html">Linearni, časovno invariantni (LTI) sistemi - zajem signalov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06%20-%20LTI%20sistemi%202%2C%20prenosne%20funkcije.html">Linearni, časovno invariantni (LTI) sistemi 2 - prenosne funkcije</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07%20-%20Enakomerno%20%C4%8Dasovno%20vzor%C4%8Denje%20in%20frekven%C4%8Dno%20prekrivanje.html">Enakomerno časovno vzorčenje in frekvenčno prekrivanje</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08%20-%20DFT%20in%20osnove%20naklju%C4%8Dnih%20procesov.html">DFT in osnove naključnih procesov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09%20-%20Naklju%C4%8Dno%20vzbujanje%2C%20zajem%20signalov.html">Naključno vzbujanje - zajem signalov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10%20-%20Naklju%C4%8Dno%20vzbujanje%202%2C%20prenosne%20funkcije.html">Naključno vzbujanje - ocena frekvenčnih prenosnih funkcij</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/domengorjup/ps_lv" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/domengorjup/ps_lv/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v strukturni dinamiki.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/Predavanje 12 - Procesiranje slik/Procesiranje slik za meritve v strukturni dinamiki.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Procesiranje slik za meritve v strukturni dinamiki</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#slikovne-meritve">Slikovne meritve</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametri-zajema">Parametri zajema</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#osvetlitev">Osvetlitev</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#priprava-povrsine-merjenca">Priprava površine merjenca</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pogoste-tezave-pri-slikovnih-meritvah">Pogoste težave pri slikovnih meritvah</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neustrezno-izostrena-slika">Neustrezno izostrena slika</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neustrezna-osvetlitev">Neustrezna osvetlitev</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">Določitev pomikov na slikah z metodo optičnega toka</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metoda-lucas-kanade">Metoda Lucas-Kanade:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#izracun-frf">Izračun FRF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev">Eskperimentalna modalna analiza (samo slikovna meritev):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#primerjava-z-meritivjo-pospeskomera">Primerjava z meritivjo pospeškomera</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="procesiranje-slik-za-meritve-v-strukturni-dinamiki">
<h1>Procesiranje slik za meritve v strukturni dinamiki<a class="headerlink" href="#procesiranje-slik-za-meritve-v-strukturni-dinamiki" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Slikovne-meritve" data-toc-modified-id="Slikovne-meritve-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Slikovne meritve</a></span><ul class="toc-item"><li><span><a href="#Parametri-zajema" data-toc-modified-id="Parametri-zajema-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Parametri zajema</a></span></li><li><span><a href="#Osvetlitev" data-toc-modified-id="Osvetlitev-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Osvetlitev</a></span></li><li><span><a href="#Priprava-površine-merjenca" data-toc-modified-id="Priprava-površine-merjenca-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Priprava površine merjenca</a></span></li><li><span><a href="#Pogoste-težave-pri-slikovnih-meritvah" data-toc-modified-id="Pogoste-težave-pri-slikovnih-meritvah-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Pogoste težave pri slikovnih meritvah</a></span><ul class="toc-item"><li><span><a href="#Neustrezno-izostrena-slika" data-toc-modified-id="Neustrezno-izostrena-slika-1.4.1"><span class="toc-item-num">1.4.1&nbsp;&nbsp;</span>Neustrezno izostrena slika</a></span></li><li><span><a href="#Neustrezna-osvetlitev" data-toc-modified-id="Neustrezna-osvetlitev-1.4.2"><span class="toc-item-num">1.4.2&nbsp;&nbsp;</span>Neustrezna osvetlitev</a></span></li></ul></li></ul></li><li><span><a href="#Določitev-pomikov-na-slikah-z-metodo-optičnega-toka-(Simplified-Optical-Flow)" data-toc-modified-id="Določitev-pomikov-na-slikah-z-metodo-optičnega-toka-(Simplified-Optical-Flow)-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Določitev pomikov na slikah z metodo optičnega toka (<em>Simplified Optical Flow</em>)</a></span></li><li><span><a href="#Metoda-Lucas-Kanade:" data-toc-modified-id="Metoda-Lucas-Kanade:-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Metoda Lucas-Kanade:</a></span></li><li><span><a href="#Izračun-FRF" data-toc-modified-id="Izračun-FRF-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Izračun FRF</a></span></li><li><span><a href="#Eskperimentalna-modalna-analiza-(samo-slikovn-meritev):" data-toc-modified-id="Eskperimentalna-modalna-analiza-(samo-slikovn-meritev):-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Eskperimentalna modalna analiza (samo slikovn meritev):</a></span></li><li><span><a href="#Eskperimentalna-modalna-analiza---hibridna-metoda" data-toc-modified-id="Eskperimentalna-modalna-analiza---hibridna-metoda-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Eskperimentalna modalna analiza - hibridna metoda</a></span></li></ul></div><p>Vsi potrebni paketi so navedeni v <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-m</span> <span class="pre">requirements.txt</span></code></p></li>
</ul>
<p>Priprava paketov in nekaterih funkcij:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">from</span> <span class="nn">orodja</span> <span class="kn">import</span> <span class="n">plot_mode_shape</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>

<span class="kn">import</span> <span class="nn">lvm_read</span>
<span class="kn">import</span> <span class="nn">pyidi</span>
<span class="kn">import</span> <span class="nn">pyEMA</span>
<span class="kn">from</span> <span class="nn">sdypy</span> <span class="kn">import</span> <span class="n">FRF</span> <span class="k">as</span>  <span class="n">pyFRF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python312\Lib\site-packages\napari\layers\utils\layer_utils.py:10: DeprecationWarning: 
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
  import pandas as pd
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python312\Lib\copy.py:151: DeprecationWarning: Pickle, copy, and deepcopy support will be removed from itertools in Python 3.14.
  rv = reductor(4)
C:\Users\Domen\AppData\Local\Programs\Python\Python312\Lib\copy.py:261: DeprecationWarning: Pickle, copy, and deepcopy support will be removed from itertools in Python 3.14.
  y.__setstate__(state)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\Domen\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyEMA\__init__.py:12: UserWarning: This is the last version of pyEMA and will not longer be maintained since it is moving to the SDyPy package. To use the latest code from SDyPy: `pip install sdypy` and `from sdypy import EMA`.
  warnings.warn(&#39;This is the last version of pyEMA and will not longer be maintained since it is moving to the SDyPy package. To use the latest code from SDyPy: `pip install sdypy` and `from sdypy import EMA`.&#39;)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">15</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="kn">import</span> <span class="nn">pyidi</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="kn">import</span> <span class="nn">pyEMA</span>
<span class="ne">---&gt; </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">sdypy</span> <span class="kn">import</span> <span class="n">FRF</span> <span class="k">as</span>  <span class="n">pyFRF</span>

<span class="ne">ImportError</span>: cannot import name &#39;FRF&#39; from &#39;sdypy&#39; (unknown location)
</pre></div>
</div>
</div>
</div>
<section id="slikovne-meritve">
<h2>Slikovne meritve<a class="headerlink" href="#slikovne-meritve" title="Link to this heading">#</a></h2>
<p><strong>Postavitev eksperimenta:</strong></p>
<img src="figures/experiment_setup.jpg" width="80%"><p><strong>Vzbujanje z modalnim kladivom:</strong></p>
<video controls loop src="figures/experiment.mp4" width="100%" rotate="270deg"/><p>Datoteke s slikami:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam_fname</span> <span class="o">=</span> <span class="s1">&#39;data/camera.cih&#39;</span>
<span class="n">lvm_fname</span> <span class="o">=</span> <span class="s1">&#39;data/acceleration.lvm&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Odpiranje posnetka s paketom <a class="reference external" href="https://github.com/ladisk/pyidi">pyidi</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">cam_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyMRAW.py:92: UserWarning: Not 12bit (8 bits)! clipped values?
  warnings.warn(&#39;Not 12bit ({:g} bits)! clipped values?&#39;.format(bits))
d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyMRAW.py:104: UserWarning: Clipped footage! (Total frame: 3750, Original total frame: 7500)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequential_image_nr</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">sequential_image_nr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/15e55d1af295c866d7184cafd7005ede2e420baf1966cac041b6eb02f49ddb56.png" src="../../_images/15e55d1af295c866d7184cafd7005ede2e420baf1966cac041b6eb02f49ddb56.png" />
</div>
</div>
<p><em>Posnetek je prilagojen prikazu in je zato slabše kavlaitete. Za natančne meritve običajno zajamemo zelo veliko količino podatkov.</em></p>
<video controls loop src="figures/video.MOV" width="950" rotate="270deg"/><section id="parametri-zajema">
<h3>Parametri zajema<a class="headerlink" href="#parametri-zajema" title="Link to this heading">#</a></h3>
<p>Parametri nastavitve kamere so zapisani v atributu <code class="docutils literal notranslate"><span class="pre">info</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Date&#39;: &#39;2018/12/17&#39;,
 &#39;Time&#39;: &#39;12:48&#39;,
 &#39;Camera Type&#39;: &#39;FASTCAM SA-Z type 2100K-M-64GB&#39;,
 &#39;Head Type&#39;: &#39;Unknown Child Device&#39;,
 &#39;Camera ID&#39;: 11,
 &#39;Camera Number&#39;: 0,
 &#39;Head Number&#39;: 1,
 &#39;Max Head Number&#39;: 1,
 &#39;Scene Name&#39;: &#39;&#39;,
 &#39;User Defined Camera Name&#39;: &#39;&#39;,
 &#39;Session Number&#39;: &#39;&#39;,
 &#39;Date Record&#39;: &#39;Unknown&#39;,
 &#39;Time Record&#39;: &#39;Unknown&#39;,
 &#39;Trigger Time&#39;: 0,
 &#39;Record Rate(fps)&#39;: 15000,
 &#39;Shutter Speed(s)&#39;: &#39;1/15371&#39;,
 &#39;Trigger Mode&#39;: &#39;Start&#39;,
 &#39;Original Total Frame&#39;: 7500,
 &#39;Total Frame&#39;: 3750,
 &#39;Start Frame&#39;: 0,
 &#39;Correct Trigger Frame&#39;: 0,
 &#39;Save Step&#39;: 1,
 &#39;Image Width&#39;: 640,
 &#39;Image Height&#39;: 40,
 &#39;Color Type&#39;: &#39;Mono&#39;,
 &#39;Color Bit&#39;: 8,
 &#39;File Format&#39;: &#39;MRaw&#39;,
 &#39;EffectiveBit Depth&#39;: 12,
 &#39;EffectiveBit Side&#39;: &#39;Higher&#39;,
 &#39;Digits Of File Number&#39;: 6,
 &#39;Device Last Error&#39;: &#39;-1:0xffffffff&#39;,
 &#39;Comment Text&#39;: &#39;&#39;,
 &#39;AnalogBoard Channel Num&#39;: 0,
 &#39;Zero Frame&#39;: &#39;Exist&#39;,
 &#39;Shutter Type2(nsec)&#39;: 65060,
 &#39;Edge Enhance&#39;: 0,
 &#39;Pre LUT Mode&#39;: &#39;DEF1&#39;,
 &#39;Pre LUT Brightness&#39;: 0,
 &#39;Pre LUT Contrast&#39;: 0,
 &#39;Pre LUT Gain&#39;: 1.0,
 &#39;Pre LUT Gamma&#39;: 1.0,
 &#39;Pre LUT PosiNega&#39;: &#39;Posi&#39;,
 &#39;DS Shutter&#39;: &#39;Value 0&#39;,
 &#39;Scale Method&#39;: 1,
 &#39;Scale Grid Space&#39;: 1,
 &#39;Scale Pixel Size&#39;: 47.193,
 &#39;Scale Unit&#39;: 1,
 &#39;Scale Magnification&#39;: 1.0,
 &#39;Scale Ruler&#39;: 1,
 &#39;Scale Distance&#39;: 1000.0,
 &#39;Scale 2Points Distance&#39;: 21.1896,
 &#39;Polarization&#39;: 0,
 &#39;Pola Config&#39;: 0,
 &#39;Pola Save Kind&#39;: 0,
 &#39;Pola Save Comment&#39;: &#39;&#39;,
 &#39;Time Code Type&#39;: 0,
 &#39;Time Code Display Unit&#39;: &#39;&#39;,
 &#39;Time Code Per Frames&#39;: 0.0,
 &#39;Time Code Start Value&#39;: 0.0,
 &#39;Time Code Unit Reset&#39;: 0.0,
 &#39;Time Code Reset&#39;: 0,
 &#39;Current Time Decimal Place&#39;: 0,
 &#39;Current Time Max Display Unit&#39;: 0,
 &#39;Current Time Decimal Divide&#39;: 0,
 &#39;Not Use&#39;: &#39;&#39;,
 &#39;Auto Exposure&#39;: &#39;Off&#39;,
 &#39;Shading&#39;: &#39;On&#39;,
 &#39;Pixel Gain&#39;: &#39;Default&#39;,
 &#39;Sync In&#39;: &#39;OFF&#39;,
 &#39;General In&#39;: &#39;EVENT POS&#39;,
 &#39;Trig TTL In&#39;: &#39;TRIG POS&#39;,
 &#39;General Out1&#39;: &#39;SYNC POS&#39;,
 &#39;General Out2&#39;: &#39;SYNC POS&#39;,
 &#39;General Out3&#39;: &#39;SYNC POS&#39;,
 &#39;Trig TTL Out&#39;: &#39;TRIG POS&#39;,
 &#39;SYNC OUT Times(times)&#39;: 1,
 &#39;IRIG&#39;: &#39;Off&#39;,
 &#39;IRIG Phase Lock&#39;: &#39;Off&#39;,
 &#39;Video Out&#39;: &#39;PAL&#39;,
 &#39;Video Out during Memory&#39;: &#39;Off&#39;,
 &#39;Total Partition&#39;: 1,
 &#39;Current Partition&#39;: 1,
 &#39;Partition 1&#39;: &#39;1789403(frame)&#39;,
 &#39;Hardware Partition Increment Mode&#39;: &#39;Off&#39;,
 &#39;Signal Delay Trigger In(nsec)&#39;: 0,
 &#39;Signal Delay Sync In(nsec)&#39;: 0,
 &#39;Signal Delay General In(nsec)&#39;: 0,
 &#39;Signal Delay VSync Out(nsec)&#39;: 0,
 &#39;Signal Delay Exposure Out(nsec)&#39;: 0,
 &#39;Signal Delay Trigger Out Width(nsec)&#39;: 10000,
 &#39;Signal Delay VSync Out Width(nsec)&#39;: 4600,
 &#39;Locked Shutter Speed&#39;: &#39;Off&#39;,
 &#39;Hardware Recording Type&#39;: &#39;READY AND TRIG&#39;,
 &#39;Locked Resolution&#39;: &#39;Off&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="osvetlitev">
<h3>Osvetlitev<a class="headerlink" href="#osvetlitev" title="Link to this heading">#</a></h3>
<p>Ustrezna osvetlitev je eden najpomembnejših parametrov pri zajemu slik s hitro kamero.</p>
<p>Pri oceni ustreznosti osvetlitve si lahko pomagamo s hitrogramom sivinskih vrendosti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_frame</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># position of observed rectangle</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span><span class="n">y0</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x0</span><span class="o">+</span><span class="n">d</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">roi</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
<span class="c1"># Formating</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grayscale value [/]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n pixels [/]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyidi\pyidi.py:268: DeprecationWarning: `self.mraw` is deprecated and will be removed in the next version. Please use `self.reader.mraw` instead.
  warnings.warn(&#39;`self.mraw` is deprecated and will be removed in the next version. Please use `self.reader.mraw` instead.&#39;, DeprecationWarning)
</pre></div>
</div>
<img alt="../../_images/a7b4530fc376c055e4ea0280b87ac7b6c918ee63380db5d489813900f07c8a12.png" src="../../_images/a7b4530fc376c055e4ea0280b87ac7b6c918ee63380db5d489813900f07c8a12.png" />
</div>
</div>
</section>
<section id="priprava-povrsine-merjenca">
<h3>Priprava površine merjenca<a class="headerlink" href="#priprava-povrsine-merjenca" title="Link to this heading">#</a></h3>
<p>Za delovanje metod določanja pomikov s slik na osnovi gradientov sivinskih vrendosti je nujno, da je površina merjenca ustrezno pripravljena.</p>
<p>Pogosto na opazovano površino apliciramo visokokontrasntni vzorec pack (<em>speckle</em>) ali črt. Identifikacija pomikov je najzaneslivejša v smeri gradienta sivinskih vrendosti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad0</span><span class="p">,</span> <span class="n">grad1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">))</span> <span class="c1"># gradient computation</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mi">200</span> <span class="c1"># position of cross section</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="p">:,</span> <span class="n">x0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Grayscale value&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">grad0</span><span class="p">[:,</span> <span class="n">x0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gradient&#39;</span><span class="p">)</span>
<span class="c1"># Formating</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Cross section&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image height [px]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Grayscale/gradient value [/]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/764b2ca8dc205c1c96faea31c79a03233fb43cd5a618938b4d839e5c0bc786c5.png" src="../../_images/764b2ca8dc205c1c96faea31c79a03233fb43cd5a618938b4d839e5c0bc786c5.png" />
</div>
</div>
</section>
<section id="pogoste-tezave-pri-slikovnih-meritvah">
<h3>Pogoste težave pri slikovnih meritvah<a class="headerlink" href="#pogoste-tezave-pri-slikovnih-meritvah" title="Link to this heading">#</a></h3>
<section id="neustrezno-izostrena-slika">
<h4>Neustrezno izostrena slika<a class="headerlink" href="#neustrezno-izostrena-slika" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout_fname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data/focus.cih&#39;</span>
<span class="n">video_layout</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">layout_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyMRAW.py:104: UserWarning: Clipped footage! (Total frame: 1, Original total frame: 44)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video_layout</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># Formating</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d218317434722e74ff9a06f1b1690dd4bfaf77a7e6fb9a0c02e849e22187423f.png" src="../../_images/d218317434722e74ff9a06f1b1690dd4bfaf77a7e6fb9a0c02e849e22187423f.png" />
</div>
</div>
</section>
<section id="neustrezna-osvetlitev">
<h4>Neustrezna osvetlitev<a class="headerlink" href="#neustrezna-osvetlitev" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">light_fname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;data/illumination.cih&#39;</span>
<span class="n">video_light</span> <span class="o">=</span> <span class="n">pyidi</span><span class="o">.</span><span class="n">pyIDI</span><span class="p">(</span><span class="n">light_fname</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyMRAW.py:104: UserWarning: Clipped footage! (Total frame: 1, Original total frame: 34)
  warnings.warn(&#39;Clipped footage! (Total frame: {}, Original total frame: {})&#39;.format(cih[&#39;Total Frame&#39;], cih[&#39;Original Total Frame&#39;] ))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_frame</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y0</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">20</span>

<span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
    <span class="n">roi</span> <span class="o">=</span> <span class="n">video_light</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">,</span> <span class="n">y0</span><span class="p">:</span><span class="n">y0</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x0</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">video_light</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[</span><span class="n">selected_frame</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">roi</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
    <span class="c1"># Formating</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">d</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Grayscale value [/]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;n pixels [/]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">260</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">interact</span><span class="p">(</span><span class="n">show</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">500</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\ipywidgets\widgets\interaction.py:43: DeprecationWarning: `ipykernel.pylab.backend_inline` is deprecated, directly use `matplotlib_inline.backend_inline`
  from ipykernel.pylab.backend_inline import flush_figures
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "5b165d6774af452b8a9dadde0cf17b93", "version_major": 2, "version_minor": 0}</script><img alt="../../_images/52ee1766da7df47fe251eb91a5c94a1a0a153f15b6c3c1e94099dba63f52ec3c.png" src="../../_images/52ee1766da7df47fe251eb91a5c94a1a0a153f15b6c3c1e94099dba63f52ec3c.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">
<h2>Določitev pomikov na slikah z metodo optičnega toka<a class="headerlink" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka" title="Link to this heading">#</a></h2>
<p>Svetlost na sliki se ohranja:
$<span class="math notranslate nohighlight">\(
	f(x, y, t) = f(x + \Delta x, y + \Delta y, t+ \Delta t).
\)</span>$</p>
<p>Sledi enačba poenostavljene metode optičnega toka za posamezno točko na sliki:
$<span class="math notranslate nohighlight">\(
s(x_j,y_k,t)=\frac{f_0(x_j,y_k)-f(x_j,y_k,t)}{|\nabla f_0|}
\)</span>$</p>
<p><span class="math notranslate nohighlight">\(s(x_j,y_k,t) \dots\)</span> pomik točke v smeri lokalnega gadienta sivinskih vrednosti</p>
<p>(<a class="reference external" href="https://github.com/ladisk/pyidi">Javh et al</a>)</p>
<p>Računamo pomike glede na referenčno sliko:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reference_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Potrebujemo slike gradienta v smeri <code class="docutils literal notranslate"><span class="pre">x</span></code> (1) in <code class="docutils literal notranslate"><span class="pre">y</span></code> (0):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad0</span><span class="p">,</span> <span class="n">grad1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">reference_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">grad0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">grad1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Za obdelavo so primerne točke z visoko vrednostjo gradienta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">border</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">border_h</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="n">reference_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">border</span> <span class="o">-</span> <span class="n">reference_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">border</span><span class="p">)</span><span class="o">//</span><span class="n">N</span><span class="p">)</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">grad0</span><span class="p">[</span><span class="n">border_h</span><span class="p">:</span><span class="o">-</span><span class="n">border_h</span><span class="p">,</span> <span class="n">w</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="n">n</span><span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">border_h</span>
<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">h</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">w</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">n</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grad0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">inds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">inds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Gradient in $y$-direction&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ce6a29e98bf884a523529b430986a4e00cdecfe6918b76103957068ef097bbe6.png" src="../../_images/ce6a29e98bf884a523529b430986a4e00cdecfe6918b76103957068ef097bbe6.png" />
</div>
</div>
<p>Enačba optičnega toka:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d_of</span> <span class="o">=</span> <span class="p">((</span><span class="n">reference_image</span><span class="p">[</span><span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">video</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">mraw</span><span class="p">[:,</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inds</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span><span class="o">.</span><span class="n">T</span>
<span class="n">d_of</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, 3750)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d_of</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fbc4ec0560&gt;
</pre></div>
</div>
<img alt="../../_images/d648c136c56191dd020105ecb1bfbf0bf4bd781f93461c39be1573affb848715.png" src="../../_images/d648c136c56191dd020105ecb1bfbf0bf4bd781f93461c39be1573affb848715.png" />
</div>
</div>
<p>Izračun pomikov s <code class="docutils literal notranslate"><span class="pre">pyidi</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_points</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">inds</span><span class="p">)</span> <span class="c1"># izbira točk za analizo</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;sof&#39;</span><span class="p">,</span>
                <span class="n">mean_n_neighbours</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračun pomikov z <code class="docutils literal notranslate"><span class="pre">get_displacements()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">video</span><span class="o">.</span><span class="n">get_displacements</span><span class="p">()</span> <span class="o">*</span> <span class="mf">8e-5</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████████████████████████████████████████████████████| 3750/3750 [00:03&lt;00:00, 1096.40it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Averaging...
Finished!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyidi\methods\_simplified_optical_flow.py:141: UserWarning: Displacement larger than 0.5 pixel
  warnings.warn(&#39;Displacement larger than 0.5 pixel&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">location</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements</span><span class="p">[</span><span class="n">location</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y)&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fbbf155a30&gt;
</pre></div>
</div>
<img alt="../../_images/5954aee259a45423a3e687f1051ba642c7b05b891b79434cab8869a22069758a.png" src="../../_images/5954aee259a45423a3e687f1051ba642c7b05b891b79434cab8869a22069758a.png" />
</div>
</div>
</section>
<section id="metoda-lucas-kanade">
<h2>Metoda Lucas-Kanade:<a class="headerlink" href="#metoda-lucas-kanade" title="Link to this heading">#</a></h2>
<p>Če enačbe optičnega toka zapišemo za podobmočje več točk na sliki, dobimo predoločen sistem enačb.</p>
<p>Rešitev predoločenega sistema v smislu najmanjše kvadratične napake nam da pomik podobmočja:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
	\begin{bmatrix}
		\Delta x \\
		\Delta y
	\end{bmatrix} =
	\begin{bmatrix}
		\sum g_x^2 &amp;\sum  g_x \, g_y \\
		\sum  g_x \, g_y &amp;\sum g_y^2
	\end{bmatrix}^{-1}
	\begin{bmatrix}
		\sum g_x \, (f-g) \\
		\sum g_y \, (f-g)
	\end{bmatrix}
\end{equation}
\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(f(\mathbf{x}) \dots\)</span> trenutna (premaknjena) slika</p>
<p><span class="math notranslate nohighlight">\(g(\mathbf{x}) \dots\)</span> referenčna slika</p>
<p>Do enake rešitve pridemo, če rešim opzimizacijski problem, v katerem iščemo parametre <span class="math notranslate nohighlight">\(\Delta \mathbf{x}\)</span>, ki premaknjeno trenutno sliko <span class="math notranslate nohighlight">\(f(\mathbf{x} + \Delta \mathbf{x})\)</span> poravnajo z referenčno <span class="math notranslate nohighlight">\(g(\mathbf{x})\)</span>:</p>
<div class="math notranslate nohighlight">
\[
SSD(\Delta \mathbf{x}) = \sum\limits_{x, y} \big[f(\mathbf{x} + \Delta \mathbf{x}) - g(\mathbf{x})\big]^2.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_lk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">*</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Image Height&#39;</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">w</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">set_points</span><span class="p">(</span><span class="n">points_lk</span><span class="p">)</span>
<span class="n">video</span><span class="o">.</span><span class="n">set_method</span><span class="p">(</span><span class="s1">&#39;lk&#39;</span><span class="p">,</span> <span class="n">roi_size</span><span class="o">=</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="n">max_nfev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">int_order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points_lk</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(15, 2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="o">.</span><span class="n">show_points</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/46d1c52eb9afee29bd759b508e79882b065c4166305b5d05ab059df0a3bfe2e8.png" src="../../_images/46d1c52eb9afee29bd759b508e79882b065c4166305b5d05ab059df0a3bfe2e8.png" />
</div>
</div>
<p>Izrčaun pomikov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#displacements_lk = video.get_displacements(processes=2) * 8e-5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements_lk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;data/displacements_lk.npy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">točka</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements_lk</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y), DIC&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">displacements</span><span class="p">[</span><span class="n">location</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Direction 0 (y), optični tok&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Image [/]]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x1fbc4e8fb00&gt;
</pre></div>
</div>
<img alt="../../_images/ef4a12eea3370ea9a33cbdbf1768b3e142475ec447ac05673d2bf641686efb2e.png" src="../../_images/ef4a12eea3370ea9a33cbdbf1768b3e142475ec447ac05673d2bf641686efb2e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">displacements_lk</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="izracun-frf">
<h2>Izračun FRF<a class="headerlink" href="#izracun-frf" title="Link to this heading">#</a></h2>
<p>Izračun amplitudnih spektrov pomikov:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Total Frame&#39;</span><span class="p">])</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="nb">int</span><span class="p">(</span><span class="n">video</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;Record Rate(fps)&#39;</span><span class="p">])</span>
<span class="mi">1</span><span class="o">/</span><span class="n">dt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15000.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">N</span>
<span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">upper_f_limit</span> <span class="o">=</span> <span class="mi">4000</span> <span class="c1"># zgornja frekvenčna meja, ki nas zanima</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="n">fft_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">displacements</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">N</span> 
</pre></div>
</div>
</div>
</div>
<p>Opazujemo le frekvence pod mejo <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code> Hz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fft_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fft_cam</span><span class="p">[:,</span> <span class="n">freq_cam</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
<span class="n">freq_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">[</span><span class="n">freq_cam</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Silo vzbujanja smo merili s silomerom.</p>
<p>Da lahko meritiv kombiniaramo, je pomembna <strong>ujemajoča frekvenčna ločljivost</strong>! Tudi tukaj se omejimo do <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lvm</span> <span class="o">=</span> <span class="n">lvm_read</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">lvm_fname</span><span class="p">)</span>
<span class="n">force</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># 30 predvzorcev</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">force</span><span class="p">)</span><span class="o">//</span><span class="mi">4</span> <span class="c1"># dolžina shranjenega videa je 0.25 s</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Delta_X&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fft_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="n">N</span>
<span class="n">freq_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">fft_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">fft_force</span><span class="p">[</span><span class="n">freq_force</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
<span class="n">freq_force</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">freq_force</span><span class="p">[</span><span class="n">freq_force</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Ker smo zajeli le en segment ne moremo uporabiti natančnejše cneilke FRF:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_cam</span> <span class="o">=</span> <span class="n">fft_cam</span><span class="o">/</span><span class="n">fft_force</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/950f332d5330c58dcbc518edb63fa685d2830b48b31802a418a17e180b61c462.png" src="../../_images/950f332d5330c58dcbc518edb63fa685d2830b48b31802a418a17e180b61c462.png" />
</div>
</div>
</section>
<section id="eskperimentalna-modalna-analiza-samo-slikovna-meritev">
<h2>Eskperimentalna modalna analiza (samo slikovna meritev):<a class="headerlink" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev" title="Link to this heading">#</a></h2>
<p>Za eksperimentalno modalno analizo uporabimo paket <a class="reference external" href="https://github.com/ladisk/pyidi"><code class="docutils literal notranslate"><span class="pre">pyEMA</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span> <span class="o">=</span> <span class="n">pyEMA</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">,</span> <span class="n">freq_cam</span><span class="p">,</span> <span class="n">pol_order_high</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper_f_limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Izračun polov modela frekvenčne prenosne funkcije:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">get_poles</span><span class="p">(</span><span class="n">show_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|███████████████████████████████████████████████████████████████| 75/75 [00:01&lt;00:00, 62.73it/s]
</pre></div>
</div>
</div>
</div>
<p>Izbrati moramo pole, ki se zdijo fizikalno smiselni (stabilni).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">select_poles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|                                                                        | 0/75 [00:00&lt;?, ?it/s]d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyEMA\stabilization.py:81: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  fn_temp[i, n - 1] = fn[i]
d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyEMA\stabilization.py:82: DeprecationWarning: Conversion of an array with ndim &gt; 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
  xi_temp[i, n - 1] = xi[i]
100%|██████████████████████████████████████████████████████████████| 75/75 [00:00&lt;00:00, 109.26it/s]
d:\pedagoško\_Procesiranje signalov\_VAJE\_PREDLOGE\Predavanje 12 - Procesiranje slik\venv\Lib\site-packages\pyEMA\pyEMA.py:811: FutureWarning: `rcond` parameter will change to the default of machine precision times ``max(M, N)`` where M and N are the input matrix dimensions.
To use the future default and silence this warning we advise to pass `rcond=None`, to keep using the old, explicitly pass `rcond=-1`.
  A_ = np.linalg.lstsq(P[mask], Y[mask])[0].T
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1600x800 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cam</span><span class="o">.</span><span class="n">print_modal_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Nat. f.      Damping
-----------------------
1)  695.6	0.0016
2) 1897.7	0.0004
</pre></div>
</div>
</div>
</div>
<p>Za rekonstrukcijo modela FRF uporabimo metodo LSFD:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_rec</span><span class="p">,</span> <span class="n">shapes_cam</span> <span class="o">=</span> <span class="n">cam</span><span class="o">.</span><span class="n">get_constants</span><span class="p">(</span><span class="n">FRF_ind</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera FRF&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_rec</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reconstructed FRF&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;frequency [Hz]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Receptance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/08a054849d23d70dd64c4524f648109a3cf9282c97a7df55ec9263ff1fe1fdb8.png" src="../../_images/08a054849d23d70dd64c4524f648109a3cf9282c97a7df55ec9263ff1fe1fdb8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">shapes_cam</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="p">):</span>
    <span class="n">plot_mode_shape</span><span class="p">(</span><span class="n">shapes_cam</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="n">cam</span><span class="o">.</span><span class="n">nat_freq</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8b810d32e1ae919a48ab9971a08f29474fbcacfd0620feea3c7c9f46eba425f2.png" src="../../_images/8b810d32e1ae919a48ab9971a08f29474fbcacfd0620feea3c7c9f46eba425f2.png" />
</div>
</div>
</section>
<section id="primerjava-z-meritivjo-pospeskomera">
<h2>Primerjava z meritivjo pospeškomera<a class="headerlink" href="#primerjava-z-meritivjo-pospeskomera" title="Link to this heading">#</a></h2>
<p>Pri hibridni metodi kombiniramo pomike s slik z visoko prostorsko ločljivostjo in meritve pospeška z visoko natančnostjo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hyb_acc</span> <span class="o">=</span> <span class="n">lvm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">9.81</span> <span class="c1"># pospeškomer</span>
</pre></div>
</div>
</div>
</div>
<p>Za oceno FRF lahk uporabimo paket <a class="reference external" href="https://github.com/ladisk/pyidi"><code class="docutils literal notranslate"><span class="pre">pyFRF</span></code></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frf_</span> <span class="o">=</span> <span class="n">pyFRF</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span>
    <span class="n">sampling_freq</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dt</span><span class="p">)),</span>
    <span class="n">exc</span><span class="o">=</span><span class="n">force</span><span class="p">,</span>
    <span class="n">resp</span><span class="o">=</span><span class="n">hyb_acc</span><span class="p">,</span>
    <span class="n">exc_type</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">,</span>
    <span class="n">resp_type</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Opazujemo le frekvenčno območj do <code class="docutils literal notranslate"><span class="pre">upper_f_limit</span></code> Hz:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_acc</span> <span class="o">=</span> <span class="n">frf_</span><span class="o">.</span><span class="n">get_f_axis</span><span class="p">()</span>
<span class="n">frf_acc</span> <span class="o">=</span> <span class="n">frf_</span><span class="o">.</span><span class="n">get_FRF</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;accelerance&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">frf_acc</span> <span class="o">=</span> <span class="n">frf_acc</span><span class="p">[</span><span class="n">freq_acc</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">]</span>
<span class="n">freq_acc</span> <span class="o">=</span> <span class="n">freq_acc</span><span class="p">[</span><span class="n">freq_acc</span><span class="o">&lt;</span><span class="n">upper_f_limit</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Pospeškomer je bil nameščen v točki z indeksom 3:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_cam</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_cam</span><span class="p">[</span><span class="n">točka</span><span class="p">]),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Camera FRF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">freq_acc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frf_acc</span> <span class="o">/</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq_acc</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Accelerometer FRF&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Camera-based response at accelerometer location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b2c0007ba62dcd84d65c1a2c10ed2331e3a3fc4ac43ad5983e9fc426083f5252.png" src="../../_images/b2c0007ba62dcd84d65c1a2c10ed2331e3a3fc4ac43ad5983e9fc426083f5252.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks\Predavanje 12 - Procesiranje slik"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#slikovne-meritve">Slikovne meritve</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parametri-zajema">Parametri zajema</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#osvetlitev">Osvetlitev</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#priprava-povrsine-merjenca">Priprava površine merjenca</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pogoste-tezave-pri-slikovnih-meritvah">Pogoste težave pri slikovnih meritvah</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neustrezno-izostrena-slika">Neustrezno izostrena slika</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#neustrezna-osvetlitev">Neustrezna osvetlitev</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dolocitev-pomikov-na-slikah-z-metodo-opticnega-toka">Določitev pomikov na slikah z metodo optičnega toka</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metoda-lucas-kanade">Metoda Lucas-Kanade:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#izracun-frf">Izračun FRF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eskperimentalna-modalna-analiza-samo-slikovna-meritev">Eskperimentalna modalna analiza (samo slikovna meritev):</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#primerjava-z-meritivjo-pospeskomera">Primerjava z meritivjo pospeškomera</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Domen Gorjup
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>